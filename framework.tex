\begin{figure*}[!h]
	\centering
	\label{fig:framework}
\tikzset{%
  >={Latex[width=2mm,length=2mm]},
  % Specifications for style of nodes:
            base/.style = {rectangle, rounded corners, draw=black,
                           minimum width=2.5cm, minimum height=1cm, 
                           text centered},
            blue/.style = {base, fill=blue!20},
             red/.style = {base, fill=red!30},
           gray/.style = {base, fill=gray!30},
         process/.style = {base, fill=orange!15},
           input/.style = {circle,draw=green!60!black, minimum size=18pt, 
                           fill=green!15!yellow, very thick},
          output/.style = {input,draw=red!60!black, fill=red!40},
        database/.style = {cylinder, fill=yellow!50,shape border rotate=90, 
                           minimum height=0.8cm, minimum width=1cm, draw},
}
\begin{tikzpicture}[node distance=1.5cm, every node/.style={fill=white, font=\sffamily}, align=center, scale=0.85, transform shape]
  % Specification of nodes (position, etc.)
  \node (input)             [input, label=above: Input dataframe]              {};
  \node (dataCalibration)     [process, right of=input, xshift=2cm]          {Data calibration};
  \node (waterDemand)     [blue, right of=dataCalibration, xshift=4cm]          {Estimate water demand};
  \node (output)             [output, right of=waterDemand, label=above: Processed dataframe, xshift=3cm]              {};
  \node (regStats)             [database, right of=dataCalibration, xshift=1cm, yshift=1.5cm, label=above: Regional statistics]              {};
  \node (withdrawals)     [blue, below of=output]          {Calculate withdrawals};
  \node (stress)     [gray, left of=withdrawals, xshift=-3cm]          {Groundwater stress};
  \node (pumpEnergy)     [red, left of=stress, xshift=-2.5cm]          {Pumping energy};
  \node (desalEnergy)     [red, left of=pumpEnergy, xshift=-2.5cm]          {Desalination energy};
  \node (clustering)     [process, below of=withdrawals, yshift=-1.5cm]          {Clustering};
  \node (costs)     [gray, below of=stress, yshift=-1.5cm]          {CAPEX \& OPEX};
  \node (lcow)     [gray, below of=pumpEnergy, yshift=-1.5cm]          {LCOW};
  \node (least)     [process, below of=desalEnergy, yshift=-1.5cm]          {Least-cost option};
  \node (specs)             [database, right of=lcow, xshift=0.5cm, yshift=1.3cm, label=above: Specifications]              {};
  \node (recWithdrawals)     [blue, below of=least, xshift=-0.3cm, text width=2.5cm]          {Recalculate withdrawals};
  \node (stress2)     [gray, right of=recWithdrawals, xshift=1.8cm, text width=2.6cm]          {Groundwater stress};
  \node (recEnergy)     [red, right of=stress2, xshift=2.8cm, text width=4.3cm]          {Recalculate pumping and desalination energy};
  \node (wasteEnergy)     [red, right of=recEnergy, xshift=3.2cm, text width=3.4cm]          {Calculate wastewater energy};
  \node (results)             [output, right of=wasteEnergy, label=above: Results, xshift=1.3cm]              {};

  % Specification of lines between nodes specified above
  \draw[->]             (input) -- (dataCalibration);
  \draw[->]             (dataCalibration) -- (waterDemand);
  \draw[->]             (waterDemand) -- (output);
  \draw[->, dashed]             (regStats) -| (dataCalibration);
  \draw[->, dashed]             (regStats) -| (waterDemand);
  \draw[->]             (output) -- ++(2.6,0) -- ++(0,-1) |- (withdrawals.east);
  \draw[->]             (withdrawals) -- (stress);
  \draw[->]             (stress) -- (pumpEnergy);
  \draw[->]             (pumpEnergy) -- (desalEnergy);
  \draw[->]             (output) ++(2.6,0) ++(0,-1.5) |- (clustering.east);
  \draw[->]             (clustering) -- (costs);
  \draw[->]             (costs) -- (lcow);
  \draw[->]             (lcow) -- (least);
  \draw[->, dashed]             (specs) -| (lcow);
  \draw[->, dashed]             (specs) -| (costs);
  \draw[->, dashed]             (specs) -| (clustering);
  \draw[->, dashed]             (specs) -| (withdrawals);
  \draw[->, dashed]             (specs) -| (stress);
  \draw[->, dashed]             (specs) -| (pumpEnergy);
  \draw[->, dashed]             (specs) -| (desalEnergy);
  \draw[->]             (desalEnergy) -- ++(-2.6,0) -- ++(0,-1) |- (recWithdrawals.west);
  \draw[-]             (least) -- ++(-2.6,0);
  \draw[->]             (recWithdrawals) -- (stress2);
  \draw[->]             (stress2) -- (recEnergy);
  \draw[->]             (recEnergy) -- (wasteEnergy);
  \draw[->]             (wasteEnergy) -- (results);

  \end{tikzpicture}
  \caption{Methodology flow diagram.}
\end{figure*} 